(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,39211,29780,e=>{"use strict";var s=e.i(32718),t=e.i(56780);let r=e.i(48127).default.env.NEXT_PUBLIC_API_URL||"http://localhost:3001",a=new class{accessToken=null;refreshToken=null;constructor(){this.accessToken=localStorage.getItem("accessToken"),this.refreshToken=localStorage.getItem("refreshToken")}setTokens(e,s){this.accessToken=e,this.refreshToken=s,localStorage.setItem("accessToken",e),localStorage.setItem("refreshToken",s)}clearTokens(){this.accessToken=null,this.refreshToken=null,localStorage.removeItem("accessToken"),localStorage.removeItem("refreshToken")}getAccessToken(){return this.accessToken}async request(e,s={}){let{method:t="GET",body:a,headers:o={},auth:n=!0}=s,c={"Content-Type":"application/json",...o};n&&this.accessToken&&(c.Authorization=`Bearer ${this.accessToken}`);try{let o=await fetch(`${r}${e}`,{method:t,headers:c,body:a?JSON.stringify(a):void 0}),u=await o.json();if(!o.ok&&401===o.status&&this.refreshToken&&n&&await this.tryRefreshToken())return this.request(e,s);return u}catch(e){return{success:!1,error:{code:"NETWORK_ERROR",message:e instanceof Error?e.message:"Network error occurred"}}}}async tryRefreshToken(){if(!this.refreshToken)return!1;try{let e=await fetch(`${r}/auth/refresh`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.accessToken}`},body:JSON.stringify({refreshToken:this.refreshToken})});if(!e.ok)return this.clearTokens(),!1;let s=await e.json();if(s.success&&s.data?.tokens)return this.setTokens(s.data.tokens.accessToken,s.data.tokens.refreshToken),!0;return this.clearTokens(),!1}catch{return this.clearTokens(),!1}}async login(e,s){return this.request("/auth/login",{method:"POST",body:{email:e,password:s},auth:!1})}async register(e,s,t){return this.request("/auth/register",{method:"POST",body:{email:e,name:s,password:t},auth:!1})}async googleAuth(e){return this.request("/auth/google",{method:"POST",body:{credential:e},auth:!1})}async getGoogleConfig(){return this.request("/auth/google/config",{method:"GET",auth:!1})}async logout(){this.refreshToken&&(await this.request("/auth/logout",{method:"POST",body:{refreshToken:this.refreshToken}}),this.clearTokens())}async getMe(){return this.request("/auth/me")}async scrape(e){return this.request("/v1/scrape",{method:"POST",body:e})}async getJob(e){return this.request(`/v1/jobs/${e}`)}async listJobs(e=1,s=20){return this.request(`/v1/jobs?page=${e}&limit=${s}`)}async listApiKeys(){return this.request("/api-keys")}async createApiKey(e,s){return this.request("/api-keys",{method:"POST",body:{name:e,permissions:s}})}async deleteApiKey(e){return this.request(`/api-keys/${e}`,{method:"DELETE"})}async getUsage(e,s){let t=new URLSearchParams;return e&&t.set("startDate",e),s&&t.set("endDate",s),this.request(`/v1/usage?${t.toString()}`)}};e.s(["apiClient",0,a],29780);let o=t.createContext(void 0);function n({children:e}){let[r,n]=t.useState(null),[c,u]=t.useState(!0),i=!!r,h=t.useCallback(async()=>{if(!a.getAccessToken()){n(null),u(!1);return}try{let e=await a.getMe();e.success&&e.data?.user?n(e.data.user):(n(null),a.clearTokens())}catch{n(null),a.clearTokens()}finally{u(!1)}},[]);t.useEffect(()=>{h()},[h]);let l=t.useCallback(async(e,s)=>{let t=await a.login(e,s);return t.success&&t.data?(a.setTokens(t.data.tokens.accessToken,t.data.tokens.refreshToken),n(t.data.user),{success:!0}):{success:!1,error:t.error?.message||"Login failed"}},[]),k=t.useCallback(async(e,s,t)=>{let r=await a.register(e,s,t);return r.success&&r.data?(a.setTokens(r.data.tokens.accessToken,r.data.tokens.refreshToken),n(r.data.user),{success:!0}):{success:!1,error:r.error?.message||"Registration failed"}},[]),T=t.useCallback(async e=>{let s=await a.googleAuth(e);return s.success&&s.data?(a.setTokens(s.data.tokens.accessToken,s.data.tokens.refreshToken),n(s.data.user),{success:!0}):{success:!1,error:s.error?.message||"Google login failed"}},[]),d=t.useCallback(async()=>{await a.logout(),n(null)},[]),g=t.useMemo(()=>({user:r,isLoading:c,isAuthenticated:i,login:l,register:k,googleLogin:T,logout:d,refreshUser:h}),[r,c,i,l,k,T,d,h]);return(0,s.jsx)(o.Provider,{value:g,children:e})}function c(){let e=t.useContext(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}e.s(["AuthProvider",()=>n,"useAuth",()=>c],39211)}]);